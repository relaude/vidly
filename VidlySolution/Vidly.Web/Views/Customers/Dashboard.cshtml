
@{
    ViewBag.Title = "Manage Customers";
}

<h2>Manage Customers</h2>

<div id="gridDiv"></div>

<script type="text/javascript">
    Ext.define('Customers', {
        extend: 'Ext.data.Model',
        fields: [
            'id', 'displayName', 'membership'
        ]
    });

    Ext.onReady(function () {
        var pageSize = 10;

        var gridStore = Ext.create('Ext.data.Store', {
            model: 'Customers',
            alias: 'store.customers',
            pageSize: pageSize,
            proxy: {
                type: 'ajax',
                url: '/api/customer',
                extraParams: {
                    search: ''
                },
                reader: {
                    type: 'json',
                    rootProperty: 'items',
                    totalProperty: 'results'
                }
            },
            autoLoad: { start: 0, limit: pageSize }
        });

        Ext.create('Ext.grid.Panel', {
            id: 'gridId',
            store: gridStore,
            stripeRows: true,
            title: 'Customers', 
            renderTo: 'gridDiv',    

            columns: [
                { text: 'ID', dataIndex: 'id' },
                { text: 'Name', dataIndex: 'displayName', flex: 1 },
                { text: 'Membership', dataIndex: 'membership', flex: 1 }
            ],

            dockedItems: [{
                xtype: 'toolbar',
                dock: 'top',
                items: [{
                        xtype: 'textfield',
                        id: 'searchField',
                        emptyText: 'Search...'
                    },{
                        xtype: 'button',
                        text: 'Search',
                        handler: function () {
                            var search = Ext.getCmp('searchField').getValue();

                            gridStore.load({
                                params: {
                                    search: search
                                }
                            });
                        }
                    },{
                        xtype: 'button',
                        text: 'Add',
                        handler: function () {

                        }
                    }]
            }],

            bbar: Ext.create('Ext.PagingToolbar', {
                store: gridStore,
                displayInfo: true
            })
        });
    });
</script>
